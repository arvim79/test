SET SCHEMA VSCODE_EXT ;

CREATE COLUMN TABLE VEND_INV
    (INV_ID NVARCHAR(10),
     INV_DATE DATE,
     VENDOR_ID NVARCHAR(10),
     AMOUNT INT,
     CURRENCY NVARCHAR(10)
    ) ;
    
 INSERT INTO VEND_INV VALUES ('100012', '2021-01-09', '40003', 2000, 'USD') ;
 INSERT INTO VEND_INV VALUES ('100072', '2021-02-09', '40003', 3000, 'USD') ;
 INSERT INTO VEND_INV VALUES ('100093', '2022-01-10', '50003', 5000, 'CAD') ;
 INSERT INTO VEND_INV VALUES ('100069', '2022-03-09', '60003', 4000, 'CAD') ;
 
 ----------------------

 CREATE COLUMN TABLE VEND_MASTER
  (VENDOR_ID NVARCHAR(10),
   "NAME" NVARCHAR(40),
   COUNTRY NVARCHAR(10)
  ) ;
  
  INSERT INTO VEND_MASTER VALUES ('40003', 'ECI MATERIALS', 'USA') ;
   INSERT INTO VEND_MASTER VALUES ('50003', 'APPLIED MATERIALS', 'CANADA') ;
   INSERT INTO VEND_MASTER VALUES ('60003', 'CLS SYSTEMS', 'CANADA') ;
   
----------------------

 CREATE COLUMN TABLE TIME_DATA
  (SQL_DATE DATE,
   YEAR NVARCHAR(4),
   MONTH NVARCHAR(2)
  ) ;
  
  INSERT INTO TIME_DATA values ('2021-01-09', '2021', '01');
 INSERT INTO TIME_DATA values ('2021-01-09', '2021', '02');
  INSERT INTO TIME_DATA values ('2022-01-10', '2022', '01');
  INSERT INTO TIME_DATA values ('2021-03-09', '2022', '03');
  INSERT INTO TIME_DATA values ('2022-03-09', '2022', '03');
  INSERT INTO TIME_DATA values ('2021-02-09', '2021', '02');
  
  
  
   
 -------------
 
 SELECT COUNTRY, SUM(AMOUNT) FROM VSCODE_EXT.VEND_INV I LEFT JOIN VSCODE_EXT.VEND_MASTER M
                           ON I.VENDOR_ID = M.VENDOR_ID
      GROUP BY COUNTRY ;
